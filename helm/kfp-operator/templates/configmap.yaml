apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "kfp-operator.name" . }}-manager-config
  namespace: {{ .Values.controller.namespace }}
data:
  controller_manager_config.yaml: |
    apiVersion: config.kubeflow.org/v1
    kind: KfpControllerConfig
    controller:
      health:
        healthProbeBindAddress: :8081
      metrics:
        bindAddress: :8080
      webhook:
        port: 9443
      leaderElection:
        leaderElect: false
        resourceName: kfp-operator-lock
    spec:
      {{- merge (.Values.configuration) (include "kfp-operator.defaultConfiguration" . | fromYaml) | toYaml | nindent 6 -}}
