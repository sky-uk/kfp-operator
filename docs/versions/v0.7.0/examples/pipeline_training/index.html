<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/kfp-operator/favicons/favicon.ico><link rel=apple-touch-icon href=/kfp-operator/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/kfp-operator/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/kfp-operator/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/kfp-operator/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/kfp-operator/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/kfp-operator/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/kfp-operator/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/kfp-operator/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/kfp-operator/favicons/android-192x192.png sizes=192x192><title>Pipeline Training | KFP-Operator</title><meta name=description content="This tutorial walks you through the creation of a simple TFX pipeline on Kubeflow Pipelines and shows you how to manage pipelines via Kubernetes Custom Resources.
The examples for this tutorial can be found on GitHub.
1. Build the Pipeline We use the same pipeline as the TFX example with a few modifications.
Create pipeline.py. Note that the pipeline definition itself is simpler because all infrastructure references, like pusher and pipeline root, will be injected by the operator before the pipeline is uploaded to Kubeflow:"><meta property="og:url" content="https://sky-uk.github.io/kfp-operator/versions/v0.7.0/examples/pipeline_training/"><meta property="og:site_name" content="KFP-Operator"><meta property="og:title" content="Pipeline Training"><meta property="og:description" content="This tutorial walks you through the creation of a simple TFX pipeline on Kubeflow Pipelines and shows you how to manage pipelines via Kubernetes Custom Resources.
The examples for this tutorial can be found on GitHub.
1. Build the Pipeline We use the same pipeline as the TFX example with a few modifications.
Create pipeline.py. Note that the pipeline definition itself is simpler because all infrastructure references, like pusher and pipeline root, will be injected by the operator before the pipeline is uploaded to Kubeflow:"><meta property="og:locale" content="en_gb"><meta property="og:type" content="article"><meta property="article:section" content="versions"><meta itemprop=name content="Pipeline Training"><meta itemprop=description content="This tutorial walks you through the creation of a simple TFX pipeline on Kubeflow Pipelines and shows you how to manage pipelines via Kubernetes Custom Resources.
The examples for this tutorial can be found on GitHub.
1. Build the Pipeline We use the same pipeline as the TFX example with a few modifications.
Create pipeline.py. Note that the pipeline definition itself is simpler because all infrastructure references, like pusher and pipeline root, will be injected by the operator before the pipeline is uploaded to Kubeflow:"><meta itemprop=wordCount content="1142"><meta name=twitter:card content="summary"><meta name=twitter:title content="Pipeline Training"><meta name=twitter:description content="This tutorial walks you through the creation of a simple TFX pipeline on Kubeflow Pipelines and shows you how to manage pipelines via Kubernetes Custom Resources.
The examples for this tutorial can be found on GitHub.
1. Build the Pipeline We use the same pipeline as the TFX example with a few modifications.
Create pipeline.py. Note that the pipeline definition itself is simpler because all infrastructure references, like pusher and pipeline root, will be injected by the operator before the pipeline is uploaded to Kubeflow:"><link rel=preload href=/kfp-operator/scss/main.min.c313892c88708e658f4adb2c03cba4ae81345ec8350e4a33abba9815df840012.css as=style integrity="sha256-wxOJLIhwjmWPStssA8ukroE0Xsg1Dkozq7qYFd+EABI=" crossorigin=anonymous><link href=/kfp-operator/scss/main.min.c313892c88708e658f4adb2c03cba4ae81345ec8350e4a33abba9815df840012.css rel=stylesheet integrity="sha256-wxOJLIhwjmWPStssA8ukroE0Xsg1Dkozq7qYFd+EABI=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/kfp-operator/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>KFP-Operator</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/kfp-operator/versions/v0.7.0><i class='fa-solid fa-book'></i><span>Documentation</span></a></li><li class=nav-item><a class=nav-link href=https://github.com/sky-uk/kfp-operator/discussions target=_blank rel=noopener><i class='fas fa-comments'></i><span>Discuss</span></a></li><li class=nav-item><a class=nav-link href=https://github.com/sky-uk/kfp-operator target=_blank rel=noopener><i class='fab fa-github pr-2'></i><span>GitHub</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>Version</a><ul class=dropdown-menu><li><a class=dropdown-item href=/kfp-operator/docs/>master</a></li><li><a class=dropdown-item href=/kfp-operator/versions/v0.6.0>v0.6.0</a></li><li><a class=dropdown-item href=/kfp-operator/versions/v0.7.0>v0.7.0</a></li></ul></div></li><li class="td-light-dark-menu nav-item dropdown"><svg class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg>
<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown data-bs-display=static aria-label="Toggle theme (auto)">
<svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class="dropdown-menu dropdown-menu-end" aria-labelledby=bd-theme-text><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true>
<svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></li></ul></div><div class="d-none d-lg-block"></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-kfp-operatorversions-li><a href=/kfp-operator/versions/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-kfp-operatorversions><span>Versions</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-kfp-operatorversionsv070-li><a href=/kfp-operator/versions/v0.7.0/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-kfp-operatorversionsv070><span>Documentation (v0.7.0)</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kfp-operatorversionsv070getting-started-li><a href=/kfp-operator/versions/v0.7.0/getting-started/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-kfp-operatorversionsv070getting-started><span>Getting Started</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070getting-startedoverview-li><a href=/kfp-operator/versions/v0.7.0/getting-started/overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070getting-startedoverview><span>Overview</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070getting-startedintroduction-li><a href=/kfp-operator/versions/v0.7.0/getting-started/introduction/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070getting-startedintroduction><span>Introduction</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070getting-startedinstallation-li><a href=/kfp-operator/versions/v0.7.0/getting-started/installation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070getting-startedinstallation><span>Installation</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kfp-operatorversionsv070operator-manual-li><a href=/kfp-operator/versions/v0.7.0/operator-manual/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-kfp-operatorversionsv070operator-manual><span>Operator Manual</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070operator-manualupgrade-guide-li><a href=/kfp-operator/versions/v0.7.0/operator-manual/upgrade-guide/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070operator-manualupgrade-guide><span>Upgrade Guide</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-kfp-operatorversionsv070examples-li><a href=/kfp-operator/versions/v0.7.0/examples/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-kfp-operatorversionsv070examples><span>Examples</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-kfp-operatorversionsv070examplespipeline_training-li><a href=/kfp-operator/versions/v0.7.0/examples/pipeline_training/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070examplespipeline_training><span class=td-sidebar-nav-active-item>Pipeline Training</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070examplespipeline_dependencies-li><a href=/kfp-operator/versions/v0.7.0/examples/pipeline_dependencies/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070examplespipeline_dependencies><span>Pipeline Dependencies</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kfp-operatorversionsv070reference-li><a href=/kfp-operator/versions/v0.7.0/reference/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-kfp-operatorversionsv070reference><span>Reference</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referenceconfiguration-li><a href=/kfp-operator/versions/v0.7.0/reference/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referenceconfiguration><span>Configuration</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kfp-operatorversionsv070referenceresources-li><a href=/kfp-operator/versions/v0.7.0/reference/resources/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-kfp-operatorversionsv070referenceresources><span>Resources</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referenceresourcespipeline-li><a href=/kfp-operator/versions/v0.7.0/reference/resources/pipeline/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referenceresourcespipeline><span>Pipeline</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referenceresourcesrunconfiguration-li><a href=/kfp-operator/versions/v0.7.0/reference/resources/runconfiguration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referenceresourcesrunconfiguration><span>RunConfiguration</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referenceresourcesrun-li><a href=/kfp-operator/versions/v0.7.0/reference/resources/run/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referenceresourcesrun><span>Run</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referenceresourcesrunschedule-li><a href=/kfp-operator/versions/v0.7.0/reference/resources/runschedule/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referenceresourcesrunschedule><span>RunSchedule</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referenceresourcesexperiment-li><a href=/kfp-operator/versions/v0.7.0/reference/resources/experiment/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referenceresourcesexperiment><span>Experiment</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kfp-operatorversionsv070referenceresourcesmigration-li><a href=/kfp-operator/versions/v0.7.0/reference/resources/migration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-kfp-operatorversionsv070referenceresourcesmigration><span>Migration</span></a><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referenceresourcesmigrationv1alpha6-li><a href=/kfp-operator/versions/v0.7.0/reference/resources/migration/v1alpha6/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referenceresourcesmigrationv1alpha6><span>v1alpha5 to v1alpha6</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referenceresourcesmigrationv1beta1-li><a href=/kfp-operator/versions/v0.7.0/reference/resources/migration/v1beta1/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referenceresourcesmigrationv1beta1><span>v1alpha6 to v1beta1</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referenceresourcesprovider-li><a href=/kfp-operator/versions/v0.7.0/reference/resources/provider/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referenceresourcesprovider><span>Provider</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kfp-operatorversionsv070referenceproviders-li><a href=/kfp-operator/versions/v0.7.0/reference/providers/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-kfp-operatorversionsv070referenceproviders><span>Providers</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referenceprovidersoverview-li><a href=/kfp-operator/versions/v0.7.0/reference/providers/overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referenceprovidersoverview><span>Overview</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referenceproviderskfp-li><a href=/kfp-operator/versions/v0.7.0/reference/providers/kfp/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referenceproviderskfp><span>Kubeflow Pipelines</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referenceprovidersvai-li><a href=/kfp-operator/versions/v0.7.0/reference/providers/vai/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referenceprovidersvai><span>Vertex AI</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referenceframeworks-li><a href=/kfp-operator/versions/v0.7.0/reference/frameworks/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referenceframeworks><span>Pipeline Frameworks</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referencerun-completion-li><a href=/kfp-operator/versions/v0.7.0/reference/run-completion/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referencerun-completion><span>Run Completion Events</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv070referencedebugging-li><a href=/kfp-operator/versions/v0.7.0/reference/debugging/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv070referencedebugging><span>Debugging</span></a></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kfp-operatorversionsv060-li><a href=/kfp-operator/versions/v0.6.0/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-kfp-operatorversionsv060><span>Documentation (v0.6.0)</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kfp-operatorversionsv060getting-started-li><a href=/kfp-operator/versions/v0.6.0/getting-started/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-kfp-operatorversionsv060getting-started><span>Getting Started</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060getting-startedoverview-li><a href=/kfp-operator/versions/v0.6.0/getting-started/overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060getting-startedoverview><span>Overview</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060getting-startedintroduction-li><a href=/kfp-operator/versions/v0.6.0/getting-started/introduction/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060getting-startedintroduction><span>Introduction</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060getting-startedinstallation-li><a href=/kfp-operator/versions/v0.6.0/getting-started/installation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060getting-startedinstallation><span>Installation</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kfp-operatorversionsv060examples-li><a href=/kfp-operator/versions/v0.6.0/examples/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-kfp-operatorversionsv060examples><span>Examples</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060examplespipeline_training-li><a href=/kfp-operator/versions/v0.6.0/examples/pipeline_training/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060examplespipeline_training><span>Pipeline Training</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060examplespipeline_dependencies-li><a href=/kfp-operator/versions/v0.6.0/examples/pipeline_dependencies/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060examplespipeline_dependencies><span>Pipeline Dependencies</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kfp-operatorversionsv060reference-li><a href=/kfp-operator/versions/v0.6.0/reference/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-kfp-operatorversionsv060reference><span>Reference</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060referenceconfiguration-li><a href=/kfp-operator/versions/v0.6.0/reference/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060referenceconfiguration><span>Configuration</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-kfp-operatorversionsv060referenceresources-li><a href=/kfp-operator/versions/v0.6.0/reference/resources/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-kfp-operatorversionsv060referenceresources><span>Resources</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060referenceresourcespipeline-li><a href=/kfp-operator/versions/v0.6.0/reference/resources/pipeline/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060referenceresourcespipeline><span>Pipeline</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060referenceresourcesrunconfiguration-li><a href=/kfp-operator/versions/v0.6.0/reference/resources/runconfiguration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060referenceresourcesrunconfiguration><span>RunConfiguration</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060referenceresourcesrun-li><a href=/kfp-operator/versions/v0.6.0/reference/resources/run/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060referenceresourcesrun><span>Run</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060referenceresourcesexperiment-li><a href=/kfp-operator/versions/v0.6.0/reference/resources/experiment/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060referenceresourcesexperiment><span>Experiment</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060referenceresourcesprovider-li><a href=/kfp-operator/versions/v0.6.0/reference/resources/provider/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060referenceresourcesprovider><span>Provider</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060referencerun-completion-li><a href=/kfp-operator/versions/v0.6.0/reference/run-completion/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060referencerun-completion><span>Run Completion Events</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060referenceproviders-li><a href=/kfp-operator/versions/v0.6.0/reference/providers/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060referenceproviders><span>Using Multiple Providers</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-kfp-operatorversionsv060referencedebugging-li><a href=/kfp-operator/versions/v0.6.0/reference/debugging/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-kfp-operatorversionsv060referencedebugging><span>Debugging</span></a></li></ul></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/sky-uk/kfp-operator/tree/master/docs-gen/content/versions/v0.7.0/examples/pipeline_training.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/sky-uk/kfp-operator/edit/master/docs-gen/content/versions/v0.7.0/examples/pipeline_training.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/sky-uk/kfp-operator/new/master/docs-gen/content/versions/v0.7.0/examples?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/sky-uk/kfp-operator/issues/new?title=Pipeline%20Training" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/sky-uk/kfp-operator/issues/new class="td-page-meta--project td-page-meta__project-issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#1-build-the-pipeline>1. Build the Pipeline</a></li><li><a href=#2-create-a-pipeline-resource>2. Create a Pipeline Resource</a></li><li><a href=#3-create-an-experiment-resource>3. Create an Experiment resource</a></li><li><a href=#4-create-a-pipeline-runconfiguration-resource>4. Create a pipeline RunConfiguration resource</a></li><li><a href=#5-optional-deploy-newly-trained-models>5. (Optional) Deploy newly trained models</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/kfp-operator/versions/>Versions</a></li><li class=breadcrumb-item><a href=/kfp-operator/versions/v0.7.0/>Documentation (v0.7.0)</a></li><li class=breadcrumb-item><a href=/kfp-operator/versions/v0.7.0/examples/>Examples</a></li><li class="breadcrumb-item active" aria-current=page>Pipeline Training</li></ol></nav><div class=td-content><h1>Pipeline Training</h1><header class=article-meta></header><p>This tutorial walks you through the creation of a simple TFX pipeline on Kubeflow Pipelines and shows you how to manage pipelines via Kubernetes Custom Resources.</p><p>The examples for this tutorial can be found on <a href=https://github.com/sky-uk/kfp-operator/blob/master/docs-gen/includes/versions/v0.7.0/quickstart>GitHub</a>.</p><h2 id=1-build-the-pipeline>1. Build the Pipeline</h2><p>We use the same pipeline as the <a href=https://www.tensorflow.org/tfx/tutorials/tfx/penguin_simple>TFX example</a> with a few modifications.</p><p>Create <code>pipeline.py</code>.
Note that the pipeline definition itself is simpler because all infrastructure references, like pusher and pipeline root, will be injected by the operator before the pipeline is uploaded to Kubeflow:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tfx.components</span> <span class=kn>import</span> <span class=n>CsvExampleGen</span><span class=p>,</span> <span class=n>Trainer</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tfx.proto</span> <span class=kn>import</span> <span class=n>trainer_pb2</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tfx.dsl.components.base.base_node</span> <span class=kn>import</span> <span class=n>BaseNode</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### Environmental parameters can be left out when using the operator.</span>
</span></span><span class=line><span class=cl><span class=c1>### Also, the return type is now a list of components instead of a pipeline.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#def create_pipeline(pipeline_name: str, pipeline_root: str, data_root: str,</span>
</span></span><span class=line><span class=cl><span class=c1>#                    module_file: str, serving_model_dir: str,</span>
</span></span><span class=line><span class=cl><span class=c1>#                    metadata_path: str) -&gt; tfx.dsl.Pipeline:</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_components</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>BaseNode</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Creates a penguin pipeline with TFX.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Brings data into the pipeline.</span>
</span></span><span class=line><span class=cl>    <span class=n>example_gen</span> <span class=o>=</span> <span class=n>CsvExampleGen</span><span class=p>(</span><span class=n>input_base</span><span class=o>=</span><span class=s1>&#39;/data&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Uses user-provided Python function that trains a model.</span>
</span></span><span class=line><span class=cl>    <span class=n>trainer</span> <span class=o>=</span> <span class=n>Trainer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>run_fn</span><span class=o>=</span><span class=s1>&#39;penguin_pipeline.trainer.run_fn&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>examples</span><span class=o>=</span><span class=n>example_gen</span><span class=o>.</span><span class=n>outputs</span><span class=p>[</span><span class=s1>&#39;examples&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>train_args</span><span class=o>=</span><span class=n>trainer_pb2</span><span class=o>.</span><span class=n>TrainArgs</span><span class=p>(</span><span class=n>num_steps</span><span class=o>=</span><span class=mi>100</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>eval_args</span><span class=o>=</span><span class=n>trainer_pb2</span><span class=o>.</span><span class=n>EvalArgs</span><span class=p>(</span><span class=n>num_steps</span><span class=o>=</span><span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>### This needs to be omitted when using the operator.</span>
</span></span><span class=line><span class=cl>    <span class=c1>#</span>
</span></span><span class=line><span class=cl>    <span class=c1>## Pushes the model to a filesystem destination.</span>
</span></span><span class=line><span class=cl>    <span class=c1>#pusher = tfx.components.Pusher(</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  model=penguin_pipeline.trainer.outputs[&#39;model&#39;],</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  push_destination=tfx.proto.PushDestination(</span>
</span></span><span class=line><span class=cl>    <span class=c1>#      filesystem=tfx.proto.PushDestination.Filesystem(</span>
</span></span><span class=line><span class=cl>    <span class=c1>#          base_directory=serving_model_dir)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Following three components will be included in the pipeline.</span>
</span></span><span class=line><span class=cl>    <span class=n>components</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=n>example_gen</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>trainer</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=c1>#pusher</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>### When using the operator, it creates the pipeline for us,</span>
</span></span><span class=line><span class=cl>    <span class=c1>### so we return the components directly instead.</span>
</span></span><span class=line><span class=cl>    <span class=c1>#</span>
</span></span><span class=line><span class=cl>    <span class=c1>#return tfx.dsl.Pipeline(</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  pipeline_name=pipeline_name,</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  pipeline_root=pipeline_root,</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  metadata_connection_config=tfx.orchestration.metadata</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  .sqlite_metadata_connection_config(metadata_path),</span>
</span></span><span class=line><span class=cl>    <span class=c1>#  components=components)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>components</span>
</span></span></code></pre></div><p>Create <code>trainer.py</code>.
The training code remains unchanged:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>absl</span> <span class=kn>import</span> <span class=n>logging</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>tensorflow</span> <span class=k>as</span> <span class=nn>tf</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tensorflow</span> <span class=kn>import</span> <span class=n>keras</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tensorflow_transform.tf_metadata</span> <span class=kn>import</span> <span class=n>schema_utils</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tfx</span> <span class=kn>import</span> <span class=n>v1</span> <span class=k>as</span> <span class=n>tfx</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tfx_bsl.public</span> <span class=kn>import</span> <span class=n>tfxio</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tensorflow_metadata.proto.v0</span> <span class=kn>import</span> <span class=n>schema_pb2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>_FEATURE_KEYS</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;culmen_length_mm&#39;</span><span class=p>,</span> <span class=s1>&#39;culmen_depth_mm&#39;</span><span class=p>,</span> <span class=s1>&#39;flipper_length_mm&#39;</span><span class=p>,</span> <span class=s1>&#39;body_mass_g&#39;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>_LABEL_KEY</span> <span class=o>=</span> <span class=s1>&#39;species&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>_TRAIN_BATCH_SIZE</span> <span class=o>=</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl><span class=n>_EVAL_BATCH_SIZE</span> <span class=o>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Since we&#39;re not generating or creating a schema, we will instead create</span>
</span></span><span class=line><span class=cl><span class=c1># a feature spec.  Since there are a fairly small number of features this is</span>
</span></span><span class=line><span class=cl><span class=c1># manageable for this dataset.</span>
</span></span><span class=line><span class=cl><span class=n>_FEATURE_SPEC</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=o>**</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>feature</span><span class=p>:</span> <span class=n>tf</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>FixedLenFeature</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=k>for</span> <span class=n>feature</span> <span class=ow>in</span> <span class=n>_FEATURE_KEYS</span>
</span></span><span class=line><span class=cl>       <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=n>_LABEL_KEY</span><span class=p>:</span> <span class=n>tf</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>FixedLenFeature</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>int64</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>_input_fn</span><span class=p>(</span><span class=n>file_pattern</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span>
</span></span><span class=line><span class=cl>              <span class=n>data_accessor</span><span class=p>:</span> <span class=n>tfx</span><span class=o>.</span><span class=n>components</span><span class=o>.</span><span class=n>DataAccessor</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>schema</span><span class=p>:</span> <span class=n>schema_pb2</span><span class=o>.</span><span class=n>Schema</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>batch_size</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>200</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>tf</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>Dataset</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Generates features and label for training.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  Args:
</span></span></span><span class=line><span class=cl><span class=s2>    file_pattern: List of paths or patterns of input tfrecord files.
</span></span></span><span class=line><span class=cl><span class=s2>    data_accessor: DataAccessor for converting input to RecordBatch.
</span></span></span><span class=line><span class=cl><span class=s2>    schema: schema of the input data.
</span></span></span><span class=line><span class=cl><span class=s2>    batch_size: representing the number of consecutive elements of returned
</span></span></span><span class=line><span class=cl><span class=s2>      dataset to combine in a single batch
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  Returns:
</span></span></span><span class=line><span class=cl><span class=s2>    A dataset that contains (features, indices) tuple where features is a
</span></span></span><span class=line><span class=cl><span class=s2>      dictionary of Tensors, and indices is a single Tensor of label indices.
</span></span></span><span class=line><span class=cl><span class=s2>  &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>data_accessor</span><span class=o>.</span><span class=n>tf_dataset_factory</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>file_pattern</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>tfxio</span><span class=o>.</span><span class=n>TensorFlowDatasetOptions</span><span class=p>(</span>
</span></span><span class=line><span class=cl>          <span class=n>batch_size</span><span class=o>=</span><span class=n>batch_size</span><span class=p>,</span> <span class=n>label_key</span><span class=o>=</span><span class=n>_LABEL_KEY</span><span class=p>),</span>
</span></span><span class=line><span class=cl>      <span class=n>schema</span><span class=o>=</span><span class=n>schema</span><span class=p>)</span><span class=o>.</span><span class=n>repeat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>_build_keras_model</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>Model</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Creates a DNN Keras model for classifying penguin data.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  Returns:
</span></span></span><span class=line><span class=cl><span class=s2>    A Keras Model.
</span></span></span><span class=line><span class=cl><span class=s2>  &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=c1># The model below is built with Functional API, please refer to</span>
</span></span><span class=line><span class=cl>  <span class=c1># https://www.tensorflow.org/guide/keras/overview for all API options.</span>
</span></span><span class=line><span class=cl>  <span class=n>inputs</span> <span class=o>=</span> <span class=p>[</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Input</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=p>,),</span> <span class=n>name</span><span class=o>=</span><span class=n>f</span><span class=p>)</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>_FEATURE_KEYS</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=n>d</span> <span class=o>=</span> <span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>concatenate</span><span class=p>(</span><span class=n>inputs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>=</span> <span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>)(</span><span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>outputs</span> <span class=o>=</span> <span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=mi>3</span><span class=p>)(</span><span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>model</span> <span class=o>=</span> <span class=n>keras</span><span class=o>.</span><span class=n>Model</span><span class=p>(</span><span class=n>inputs</span><span class=o>=</span><span class=n>inputs</span><span class=p>,</span> <span class=n>outputs</span><span class=o>=</span><span class=n>outputs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>optimizer</span><span class=o>=</span><span class=n>keras</span><span class=o>.</span><span class=n>optimizers</span><span class=o>.</span><span class=n>Adam</span><span class=p>(</span><span class=mf>1e-2</span><span class=p>),</span>
</span></span><span class=line><span class=cl>      <span class=n>loss</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>losses</span><span class=o>.</span><span class=n>SparseCategoricalCrossentropy</span><span class=p>(</span><span class=n>from_logits</span><span class=o>=</span><span class=kc>True</span><span class=p>),</span>
</span></span><span class=line><span class=cl>      <span class=n>metrics</span><span class=o>=</span><span class=p>[</span><span class=n>keras</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>SparseCategoricalAccuracy</span><span class=p>()])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>model</span><span class=o>.</span><span class=n>summary</span><span class=p>(</span><span class=n>print_fn</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>model</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># TFX Trainer will call this function.</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>run_fn</span><span class=p>(</span><span class=n>fn_args</span><span class=p>:</span> <span class=n>tfx</span><span class=o>.</span><span class=n>components</span><span class=o>.</span><span class=n>FnArgs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Train the model based on given args.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  Args:
</span></span></span><span class=line><span class=cl><span class=s2>    fn_args: Holds args used to train the model as name/value pairs.
</span></span></span><span class=line><span class=cl><span class=s2>  &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># This schema is usually either an output of SchemaGen or a manually-curated</span>
</span></span><span class=line><span class=cl>  <span class=c1># version provided by pipeline author. A schema can also derived from TFT</span>
</span></span><span class=line><span class=cl>  <span class=c1># graph if a Transform component is used. In the case when either is missing,</span>
</span></span><span class=line><span class=cl>  <span class=c1># `schema_from_feature_spec` could be used to generate schema from very simple</span>
</span></span><span class=line><span class=cl>  <span class=c1># feature_spec, but the schema returned would be very primitive.</span>
</span></span><span class=line><span class=cl>  <span class=n>schema</span> <span class=o>=</span> <span class=n>schema_utils</span><span class=o>.</span><span class=n>schema_from_feature_spec</span><span class=p>(</span><span class=n>_FEATURE_SPEC</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>train_dataset</span> <span class=o>=</span> <span class=n>_input_fn</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>fn_args</span><span class=o>.</span><span class=n>train_files</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>fn_args</span><span class=o>.</span><span class=n>data_accessor</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>schema</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>batch_size</span><span class=o>=</span><span class=n>_TRAIN_BATCH_SIZE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>eval_dataset</span> <span class=o>=</span> <span class=n>_input_fn</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>fn_args</span><span class=o>.</span><span class=n>eval_files</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>fn_args</span><span class=o>.</span><span class=n>data_accessor</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>schema</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>batch_size</span><span class=o>=</span><span class=n>_EVAL_BATCH_SIZE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>model</span> <span class=o>=</span> <span class=n>_build_keras_model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=n>train_dataset</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>steps_per_epoch</span><span class=o>=</span><span class=n>fn_args</span><span class=o>.</span><span class=n>train_steps</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>validation_data</span><span class=o>=</span><span class=n>eval_dataset</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>validation_steps</span><span class=o>=</span><span class=n>fn_args</span><span class=o>.</span><span class=n>eval_steps</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># The result of the training should be saved in `fn_args.serving_model_dir`</span>
</span></span><span class=line><span class=cl>  <span class=c1># directory.</span>
</span></span><span class=line><span class=cl>  <span class=n>model</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>fn_args</span><span class=o>.</span><span class=n>serving_model_dir</span><span class=p>,</span> <span class=n>save_format</span><span class=o>=</span><span class=s1>&#39;tf&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>Create <code>Dockerfile</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=s>python:3.10.12</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ARG</span> WHEEL_VERSION<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> mkdir /data<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> wget https://raw.githubusercontent.com/tensorflow/tfx/master/tfx/examples/penguin/data/labelled/penguins_processed.csv -P /data<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> dist/*-<span class=si>${</span><span class=nv>WHEEL_VERSION</span><span class=si>}</span>-*.whl /<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> pip install /*.whl <span class=o>&amp;&amp;</span> rm /*.whl<span class=err>
</span></span></span></code></pre></div><p>Next, build the pipeline as a Docker container and push it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker build . -t kfp-quickstart:v1
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>docker push kfp-quickstart:v1
</span></span></code></pre></div><h2 id=2-create-a-pipeline-resource>2. Create a Pipeline Resource</h2><p>Now that we have a pipeline image, we can create a <code>pipeline.yaml</code> resource to manage the lifecycle of this pipeline on Kubeflow:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>pipelines.kubeflow.org/v1beta1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>penguin-pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>provider</span><span class=p>:</span><span class=w> </span><span class=l>provider-namespace/kfp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>kfp-quickstart:v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>framework</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>tfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>parameters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>pipeline</span><span class=p>:</span><span class=w> </span><span class=l>penguin_pipeline.pipeline.create_components</span><span class=w>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f resources/pipeline.yaml
</span></span></code></pre></div><p>The pipeline now gets uploaded to Kubeflow in several steps. After a few seconds to minutes, the following command should result in a success:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pipeline
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME               SYNCHRONIZATIONSTATE   PROVIDERID
</span></span><span class=line><span class=cl>penguin-pipeline   Succeeded              53905abe-0337-48de-875d-67b9285f3cf7
</span></span></code></pre></div><p>Now visit your Kubeflow Pipelines UI. You should be able to see the newly created pipeline named <code>penguin-pipeline</code>. Note that you will see two versions: &lsquo;penguin-pipeline&rsquo; and &lsquo;v1&rsquo;. This is due to an <a href=https://github.com/kubeflow/pipelines/issues/5881>open issue on Kubeflow</a> where you can&rsquo;t specify a version when creating a pipeline.</p><h2 id=3-create-an-experiment-resource>3. Create an Experiment resource</h2><p>Note: this step is optional. You can continue with the next step if you want to use the <code>Default</code> experiment instead.</p><p>Create <code>experiment.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>pipelines.kubeflow.org/v1beta1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Experiment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>penguin-experiment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>An experiment for the penguin pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>provider</span><span class=p>:</span><span class=w> </span><span class=l>provider-namespace/kfp</span><span class=w>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f resources/experiment.yaml
</span></span></code></pre></div><h2 id=4-create-a-pipeline-runconfiguration-resource>4. Create a pipeline RunConfiguration resource</h2><p>We can now define a recurring run declaratively using the <code>RunConfiguration</code> resource.</p><p>Note: remove <code>experimentName</code> if you want to use the <code>Default</code> experiment instead of <code>penguin-experiment</code></p><p>Create <code>runconfiguration.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>pipelines.kubeflow.org/v1beta1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>RunConfiguration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>penguin-pipeline-recurring-run</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>provider</span><span class=p>:</span><span class=w> </span><span class=l>provider-namespace/kfp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>pipeline</span><span class=p>:</span><span class=w> </span><span class=l>penguin-pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>experimentName</span><span class=p>:</span><span class=w> </span><span class=l>penguin-experiment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>triggers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>schedules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>cronExpression</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w> </span>*<span class=w> </span>*<span class=w> </span>*<span class=w> </span>*<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>startTime</span><span class=p>:</span><span class=w> </span><span class=ld>2024-01-01T00:00:00Z</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endTime</span><span class=p>:</span><span class=w> </span><span class=ld>2024-12-31T23:59:59Z</span><span class=w>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f resources/runconfiguration.yaml
</span></span></code></pre></div><p>This will trigger run of <code>penguin-pipeline</code> once every hour. Note that the cron schedule uses a 6-place space separated syntax as defined <a href=https://pkg.go.dev/github.com/robfig/cron#hdr-CRON_Expression_Format>here</a>.</p><h2 id=5-optional-deploy-newly-trained-models>5. (Optional) Deploy newly trained models</h2><p>If the operator has been installed with <a href=https://argoproj.github.io/argo-events/>Argo-Events</a> support, we can now specify eventsources and sensors to update arbitrary Kubernetes config when a pipeline has been trained successfully.
In this example we are updating a serving component with the location of the newly trained model.</p><p>Create <code>apply-model-location.yaml</code>. This creates an <code>EventSource</code> and a <code>Sensor</code> as well as an <code>EventBus</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>argoproj.io/v1alpha1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>EventBus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>nats</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>native</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>argoproj.io/v1alpha1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>EventSource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>run-completion</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>nats</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run-completion</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>jsonBody</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>subject</span><span class=p>:</span><span class=w> </span><span class=l>events</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>nats://eventbus-kfp-operator-events-stan-svc.kfp-operator.svc:4222</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>argoproj.io/v1alpha1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Sensor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>penguin-pipeline-model-update</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>serviceAccountName</span><span class=p>:</span><span class=w> </span><span class=l>events-sa</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dependencies</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>run-completion</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>eventSourceName</span><span class=p>:</span><span class=w> </span><span class=l>run-completion</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>eventName</span><span class=p>:</span><span class=w> </span><span class=l>run-completion</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>data</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>body.data.status</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>comparator</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;=&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>value</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=s2>&#34;succeeded&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>body.data.pipelineName</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>comparator</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;=&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>value</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=s2>&#34;penguin-pipeline&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>triggers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>update</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>k8s</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>operation</span><span class=p>:</span><span class=w> </span><span class=l>update</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>source</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>resource</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ConfigMap</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>serving-config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>data</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>servingModel</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>parameters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>src</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>dependencyName</span><span class=p>:</span><span class=w> </span><span class=l>run-completion</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>dataKey</span><span class=p>:</span><span class=w> </span><span class=l>body.data.artifacts.0.location</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>dest</span><span class=p>:</span><span class=w> </span><span class=l>data.servingModel</span><span class=w>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f resources/apply-model-location.yaml
</span></span></code></pre></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"></div></div></div></footer></div><script src=/kfp-operator/js/main.min.b22284f36a14e3cf2b5ae38e0b26415f6dc44542030b848166e327e05512a0cb.js integrity="sha256-siKE82oU488rWuOOCyZBX23ERUIDC4SBZuMn4FUSoMs=" crossorigin=anonymous></script><script defer src=/kfp-operator/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/kfp-operator/js/tabpane-persist.js></script></body></html>